1)Код был тестирован. Изменил способ загрузки секторов для большей читаемости кода.
2)Мне было легче написать подсчёт по таблицам.
3)Всё исправлено.